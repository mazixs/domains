# Domain Availability Checker

Проверка доступности доменов с четырёхуровневой валидацией: DNS → HTTP → TCP → Ping.

## Архитектура

```
┌─────────────────────────────────────────────────────────────┐
│                      Входные данные                         │
│              list.txt (дубликаты удаляются)                 │
└─────────────────────┬───────────────────────────────────────┘
                      ▼
┌─────────────────────────────────────────────────────────────┐
│              asyncio.Semaphore(30)                          │
│         Ограничение параллельных задач                      │
└─────────────────────┬───────────────────────────────────────┘
                      ▼
┌─────────────────────────────────────────────────────────────┐
│  ┌─────────┐   ┌──────────┐   ┌────────┐   ┌────────┐       │
│  │   DNS   │──▶│   HTTP   │──▶│  TCP   │──▶│  Ping  │       │
│  │ aiodns  │   │ aiohttp  │   │ :443   │   │  ICMP  │       │
│  │ +retry  │   │ +SNI     │   │ :80    │   │        │       │
│  └────┬────┘   └────┬─────┘   └────┬───┘   └────┬───┘       │
│       │             │              │            │           │
│    FAIL?         SUCCESS?       SUCCESS?     FALLBACK       │
│       │             │              │            │           │
│       ▼             ▼              ▼            ▼           │
│    DEAD          ALIVE          ALIVE      ALIVE/DEAD       │
└─────────────────────────────────────────────────────────────┘
                      ▼
┌─────────────────────────────────────────────────────────────┐
│              asyncio.as_completed()                         │
│       Результаты по мере готовности (без барьеров)          │
└─────────────────────────────────────────────────────────────┘
                      ▼
┌─────────────────────────────────────────────────────────────┐
│           Интерактивное удаление мёртвых доменов            │
│              (Y/N по каждому домену)                        │
└─────────────────────────────────────────────────────────────┘
```

## Логика проверки

| Шаг | Проверка | Результат | Действие |
|-----|----------|-----------|----------|
| 1 | DNS резолвится? | Нет | Домен **мёртв** |
| 2 | HTTP отвечает? | Да | Домен **жив** |
| 3 | TCP порт 443/80 открыт? | Да | Домен **жив** (API, телеметрия) |
| 4 | Ping работает? | Да/Нет | Последний fallback |

**Особенности:**
- **DNS Retry** — 2 попытки с паузой (защита от ложных срабатываний)
- **SNI поддержка** — корректная работа с CDN (Cloudflare, Instagram)
- **TCP проверка** — обнаружение API-серверов, игнорирующих HTTP
- **Дедупликация** — автоматическое удаление дубликатов при загрузке
- **User-Agent** — обход простых блокировок ботов

## Файлы

| Файл | Назначение |
|------|------------|
| `list.txt` | Домены для проверки (комментарии `##` игнорируются) |
| `test.py` | Основной скрипт проверки |
| `requirements.txt` | Зависимости |

## Требования

- **Python**: 3.10+ (рекомендуется 3.11+)
- **ОС**: Windows / Linux / macOS

## Установка

```bash
# Виртуальное окружение
python -m venv .venv

# Активация
# Windows:
.venv\Scripts\activate
# Linux/macOS:
source .venv/bin/activate

# Зависимости
pip install -r requirements.txt
```

## Запуск

```bash
python test.py
```

**Пример вывода:**
```
Начало проверки 391 доменов...
Метод: DNS → HTTP → TCP → Ping

Прогресс: 391/391 (100.0%)

==================================================
Проверено: 391
Рабочих:   390
Мёртвых:   1

==================================================
Мёртвые домены:
  - example.com [DNS✗]

Удалить мёртвые домены из list.txt? (Y/N): y
Удалить 'example.com' [DNS✗]? (Y/N): y

Удалено: 1 доменов
```

## Зависимости

| Пакет | Назначение |
|-------|------------|
| `aiodns` | Асинхронные DNS-запросы через публичные серверы (1.1.1.1, 8.8.8.8, 9.9.9.9) |
| `aiohttp` | Асинхронные HTTP-запросы с поддержкой SNI |